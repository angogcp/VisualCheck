{% extends "base.html" %}

{% block content %}
<div class="page-container">

    <!-- â”€â”€ ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€ -->
    <div class="page-header">
        <div class="page-header-left">
            <h1>ğŸ“Š æ¤œæŸ»ãƒ¬ãƒãƒ¼ãƒˆ</h1>
            <span class="page-header-sub">æ—¥åˆ¥æ¤œæŸ»çµ±è¨ˆãƒ»å“è³ªãƒˆãƒ¬ãƒ³ãƒ‰</span>
        </div>
    </div>

    <!-- â”€â”€ æœ¬æ—¥ã®ã‚µãƒãƒªãƒ¼ â”€â”€ -->
    <div class="report-summary">
        <div class="card glass-card summary-card summary-total">
            <div class="summary-icon">ğŸ“‹</div>
            <div class="summary-value" id="today-total">0</div>
            <div class="summary-label">æœ¬æ—¥ã®æ¤œæŸ»æ•°</div>
        </div>
        <div class="card glass-card summary-card summary-ok">
            <div class="summary-icon">âœ“</div>
            <div class="summary-value" id="today-ok">0</div>
            <div class="summary-label">OK</div>
        </div>
        <div class="card glass-card summary-card summary-ng">
            <div class="summary-icon">âœ—</div>
            <div class="summary-value" id="today-ng">0</div>
            <div class="summary-label">NG</div>
        </div>
        <div class="card glass-card summary-card summary-rate">
            <div class="summary-icon">ğŸ“ˆ</div>
            <div class="summary-value" id="today-rate">â€”</div>
            <div class="summary-label">åˆæ ¼ç‡</div>
        </div>
    </div>

    <!-- â”€â”€ åˆæ ¼ç‡ãƒãƒ¼ â”€â”€ -->
    <div class="card glass-card pass-rate-card">
        <div class="card-header">
            <h2>æœ¬æ—¥ã®åˆæ ¼ç‡</h2>
        </div>
        <div class="pass-rate-bar-container">
            <div class="pass-rate-bar">
                <div class="pass-rate-fill" id="pass-rate-fill" style="width: 0%"></div>
            </div>
            <div class="pass-rate-labels">
                <span class="rate-label-ok">OK: <strong id="rate-ok-count">0</strong></span>
                <span class="rate-label-ng">NG: <strong id="rate-ng-count">0</strong></span>
            </div>
        </div>
    </div>

    <div class="report-grid">
        <!-- â”€â”€ æ—¥åˆ¥å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ« â”€â”€ -->
        <div class="card glass-card history-card">
            <div class="card-header">
                <h2>ğŸ“… æ—¥åˆ¥æ¤œæŸ»å±¥æ­´ï¼ˆç›´è¿‘30æ—¥ï¼‰</h2>
            </div>
            <div class="history-table-wrap">
                <table class="history-table" id="history-table">
                    <thead>
                        <tr>
                            <th>æ—¥ä»˜</th>
                            <th>OK</th>
                            <th>NG</th>
                            <th>æœªåˆ†é¡</th>
                            <th>åˆè¨ˆ</th>
                            <th>åˆæ ¼ç‡</th>
                        </tr>
                    </thead>
                    <tbody id="history-tbody">
                        {% for day in daily %}
                        <tr>
                            <td class="date-cell">{{ day.date }}</td>
                            <td class="ok-cell">{{ day.ok }}</td>
                            <td class="ng-cell">{{ day.ng }}</td>
                            <td class="unlabeled-cell">{{ day.unlabeled }}</td>
                            <td class="total-cell">{{ day.total }}</td>
                            <td class="rate-cell">
                                {% if day.ok + day.ng > 0 %}
                                {{ "%.1f" | format(day.ok / (day.ok + day.ng) * 100) }}%
                                {% else %}
                                â€”
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                        {% if not daily %}
                        <tr>
                            <td colspan="6" class="empty-row">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- â”€â”€ ç´¯è¨ˆçµ±è¨ˆ â”€â”€ -->
        <div class="card glass-card cumulative-card">
            <div class="card-header">
                <h2>ğŸ“ˆ ç´¯è¨ˆçµ±è¨ˆ</h2>
            </div>
            <div class="cumulative-stats">
                <div class="cum-stat">
                    <div class="cum-value stat-ok-text">{{ stats.ok }}</div>
                    <div class="cum-label">OKåˆè¨ˆ</div>
                </div>
                <div class="cum-stat">
                    <div class="cum-value stat-ng-text">{{ stats.ng }}</div>
                    <div class="cum-label">NGåˆè¨ˆ</div>
                </div>
                <div class="cum-stat">
                    <div class="cum-value stat-unlabeled-text">{{ stats.unlabeled }}</div>
                    <div class="cum-label">æœªåˆ†é¡</div>
                </div>
                <div class="cum-stat">
                    <div class="cum-value" style="color: var(--text-primary);">{{ stats.total }}</div>
                    <div class="cum-label">ç·æ¤œæŸ»æ•°</div>
                </div>
                <div class="cum-stat cum-rate">
                    <div class="cum-value" style="color: var(--accent-blue);">
                        {% if stats.ok + stats.ng > 0 %}
                        {{ "%.1f" | format(stats.ok / (stats.ok + stats.ng) * 100) }}%
                        {% else %}
                        â€”
                        {% endif %}
                    </div>
                    <div class="cum-label">ç´¯è¨ˆåˆæ ¼ç‡</div>
                </div>
            </div>

            <!-- â”€â”€ æœ€è¿‘ã®NGç”»åƒ â”€â”€ -->
            <div class="recent-ng-section">
                <h3 class="section-subtitle">âš ï¸ æœ€è¿‘ã®NGç”»åƒ</h3>
                <div class="recent-ng-grid" id="recent-ng-grid">
                    <!-- JS ã§å‹•çš„ã«èª­ã¿è¾¼ã¿ -->
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/reports.js') }}"></script>
{% endblock %}